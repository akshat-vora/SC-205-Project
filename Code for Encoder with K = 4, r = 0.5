%% This is the MATLAB code
function [Trans] = encoder(Signal)
    state = '000';
    len_sig = length(Signal);
    Signal(len_sig+1) = 0;
    Signal(len_sig+2) = 0;
    Signal(len_sig+3) = 0;
    len_sig = length(Signal);
    for j=1:len_sig
        if strcmp(state,'000')
            [Trans(2*(j-1)+2),Trans(2*(j-1)+1),state] = State_fun_000(Signal(j));
        elseif strcmp(state,'001')
            [Trans(2*(j-1)+2),Trans(2*(j-1)+1),state] = State_fun_001(Signal(j));
        elseif strcmp(state,'010')
            [Trans(2*(j-1)+2),Trans(2*(j-1)+1),state] = State_fun_010(Signal(j));
        elseif strcmp(state,'011')
            [Trans(2*(j-1)+2),Trans(2*(j-1)+1),state] = State_fun_011(Signal(j));
        elseif strcmp(state,'100')
            [Trans(2*(j-1)+2),Trans(2*(j-1)+1),state] = State_fun_100(Signal(j));
        elseif strcmp(state,'101')
            [Trans(2*(j-1)+2),Trans(2*(j-1)+1),state] = State_fun_101(Signal(j));
        elseif strcmp(state,'110')
            [Trans(2*(j-1)+2),Trans(2*(j-1)+1),state] = State_fun_110(Signal(j));
        elseif strcmp(state,'111')
            [Trans(2*(j-1)+2),Trans(2*(j-1)+1),state] = State_fun_111(Signal(j));
        end
    end
end

function[p0, p1, state] = State_fun_000(x)
    if x==0
        p0 = 0;
        p1 = 0;
        state = '000';
    else
        p0 = 1;
        p1 = 1;
        state = '001';
    end
end
function[p0, p1, state] = State_fun_001(x)
    if x==0
        p0 = 1;
        p1 = 0;
        state = '010';
    else
        p0 = 0;
        p1 = 1;
        state = '011';
    end
end
function[p0, p1, state] = State_fun_010(x)
    if x==0
        p0 = 1;
        p1 = 1;
        state = '100';
    else
        p0 = 0;
        p1 = 0;
        state = '101';
    end
end
function[p0, p1, state] = State_fun_011(x)
    if x==0
        p0 = 0;
        p1 = 1;
        state = '110';
    else
        p0 = 1;
        p1 = 0;
        state = '111';
    end
end
function[p0, p1, state] = State_fun_100(x)
    if x==0
        p0 = 1;
        p1 = 1;
        state = '000';
    else
        p0 = 0;
        p1 = 0;
        state = '001';
    end
end
function[p0, p1, state] = State_fun_101(x)
    if x==0
        p0 = 0;
        p1 = 1;
        state = '010';
    else
        p0 = 1;
        p1 = 0;
        state = '011';
    end
end
function[p0, p1, state] = State_fun_110(x)
    if x==0
        p0 = 0;
        p1 = 0;
        state = '100';
    else
        p0 = 1;
        p1 = 1;
        state = '101';
    end
end
function[p0, p1, state] = State_fun_111(x)
    if x==0
        p0 = 1;
        p1 = 0;
        state = '110';
    else
        p0 = 0;
        p1 = 1;
        state = '111';
    end
end
